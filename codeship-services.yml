builder:
  build:
    image: splunk/fluent-plugin-splunk-hec
    dockerfile_path: Dockerfile
  cached: false

unittests:
  build:
    image: splunk/fluent-plugin-splunk-hec
    dockerfile_path: Dockerfile
  volumes_from:
    - builder

awsdeployment:
  image: codeship/aws-deployment
  encrypted_env_file: aws-deployment.env.encrypted
  environment:
    - AWS_DEFAULT_REGION=us-east-1
  volumes:
    - ./:/deploy

splunk-hec:
  build:
    image: splunkhec
    dockerfile_path: Dockerfile.Splunk
  hostname: splunk-hec
  environment:
  - SPLUNK_START_ARGS=--accept-license
  - SPLUNK_USER=root