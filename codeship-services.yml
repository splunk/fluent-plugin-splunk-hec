builder:
  build:
    image: splunk/fluent-plugin-splunk-hec
    dockerfile_path: Dockerfile
  hostname: fluent-plugin-splunk-hec
  cached: true

unittests:
  build:
    image: splunk/fluent-plugin-splunk-hec
    dockerfile_path: Dockerfile
  volumes_from:
    - builder

deploysplunk:
  build:
    image: splunkimage
    dockerfile_path: Dockerfile-Splunk
  hostname: splunk
  environment:
  - SPLUNK_START_ARGS=--accept-license
  - SPLUNK_USER=root

fluentd:
  build:
    image: fluentd
    dockerfile_path: Dockerfile-Fluentd
    hostname: fluentd
    volumes_from:
      - builder
    